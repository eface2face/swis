<script src="swis.js"></script>
<script>

	

	var source;

	
	var transport = {
		onload : null,
		onmessage : null,
		send : function(data) {
			source.postMessage(data, "*");
		}
	};

	var reflector = new swis.Reflector(transport);
	
	
	window.addEventListener("message", function(message){
		reflector.reflect(document);
		//Get source
		source = message.source;
		//Init transport
		transport.onload(message.data);

		//Listen again fro new messages
		window.addEventListener("message", function(message){
			//Init transport
			transport.onmessage(message.data);
		});
	});
	
	/*
	var ws = new WebSocket("wss://dev.ef2f.com/cobrowse/2");
	ws.binaryType = "arraybuffer";
	ws.onopen = function(){
		//Start reflecting DOM	
		reflect(transport,document);
	};	
	
	ws.onmessage = function(message) {
		//Check if first message
		if (!inited)
		{
			//Inited now
			inited = true;
			//Init transport
			transport.onInit(String.fromCharCode(message.data));
		} else {
			//Process messages
			transport.onMessages(JSON.parse(String.fromCharCode(message.data)));
		}
	}*/
</script>